# + ------------------------------- +
# | Exports                         |
# + ------------------------------- +
export NVM_DIR="$HOME/.nvm" && source "$NVM_DIR/nvm.sh"
export GROOVY_HOME=/usr/local/opt/groovy/libexec
export KUB_HOME="$HOME/.kube"
export PATH=$(brew --prefix coreutils)/libexec/gnubin:$PATH

if [ -r "$HOME/utils/bin" ]; then
  export PATH=$HOME/utils/bin:$PATH
fi
# ██████████████████████████████████████████████████████████

# + ------------------------------- +
# | Sourcing                       |
# + ------------------------------- +
[ -r "$NVM_DIR" ] && source "$NVM_DIR/nvm.sh"

# Setup z only when the when not in zsh shell and z.sh is present.
[ -z "$ZSH_VERSION" ] && [ -r "$HOME/utils/z/revision/z.sh" ] && source "$HOME/utils/z/revision/z.sh"
# ██████████████████████████████████████████████████████████

# + ------------------------------- +
# | Functions                       |
# + ------------------------------- +
# Set up aliases for changing java versions quickly.
function create-java-alias() {
  local bin=$(/usr/libexec/java_home -v $1 2> /dev/null)

  if [[ bin != "" ]]; then
    v="${version//\./_}"
    v="${v//1_/}"
    h=JAVA_"$v"_HOME
  
    # This creates an env variable for each java version
    export "$h"=$bin
    
    # This creates an alias that allows changing java versions
    alias "java-$v"="export JAVA_HOME=\$$h; java -version"

    return 0
  else
    >&2 echo "Could not find a java executable matching version $1"

    exit 1  
  fi
}

function git-remote-url() {
 local rmt=$1; shift || { printf "Usage: git-remote-url [REMOTE]\n" >&2; return 1; }
 local url

 if ! git config --get remote.${rmt}.url &>/dev/null; then
  printf "%s\n" "Error: not a valid remote name" && return 1
  # Verify remote using 'git remote -v' command
 fi

 url=`git config --get remote.${rmt}.url`

 # Parse remote if local clone used SSH checkout
 [[ "$url" == git@* ]] && {
 	url="${url##*@}" >&2; # Extract substring from "@"
 	url="${url%%.git}" >&2; # Extract substring until ".git"
 	url="http://${url%%:*}/${url##*:}"
 };

 printf "%s\n" "$url"
}
# ██████████████████████████████████████████████████████████

# + ------------------------------- +
# | Aliases                         |
# + ------------------------------- +
# alias kubectl-alias-name='kubectl -n prod "$@" --kubeconfig="$KUB_HOME/kubectl-config"'

alias gitrepo='chrome `git-remote-url origin`'

create-java-alias 1.7 2> /dev/null
create-java-alias 1.8 2> /dev/null
create-java-alias 11 2> /dev/null
# ██████████████████████████████████████████████████████████

# xcode-select --install